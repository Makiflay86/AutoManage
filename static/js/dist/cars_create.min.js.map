{"version":3,"sources":["cars_create.js"],"names":["selectedFiles","mainFile","document","querySelector","getElementById","mainInput","imageInput","previewContainer","thumbContainer","syncFormset","refreshVisuals","forEach","input","i","dt","DataTransfer","items","add","files","carouselInner","innerHTML","allImages","push","concat","length","url","URL","createObjectURL","file","item","createElement","className","thumb","setAttribute","appendChild","formsetInputs","querySelectorAll","addEventListener","e","Array","from","target","div","onclick","filter","f","el","classList","remove","activeIdx","indexOf"],"mappings":"aAAA,IAAIA,cAAgB,GAChBC,SAAW,KADXD,UAAaE,SAAjBC,cAAA,wBACIF,WAAJC,SAAAE,eAAA,cACMC,iBAAqBF,SAAAA,eAAc,oBACnCG,eAAaJ,SAASE,eAAe,kBACrCG,cAAgBL,SAAWE,eAAR,qBACnBI,cAAiBN,SAASE,iBAAe,qCA0B3CK,SAAAA,cACAC,cAAcC,QAAA,SAAAC,EAAAC,GAlBlB,IAAAC,EAAA,IAAAC,aAwBYf,cAAca,IAAIC,EAAGE,MAAMC,IAAIjB,cAAca,IAHzDD,EAASH,MAATK,EAAuBI,QAIfN,SAAKF,iBAHTS,cAAAC,UAAA,GAKHZ,eAAAY,UAAA,GAKG,IAAIC,EAAY,GAHpBpB,UAASS,EAAiBY,KAAArB,UAGtB,KAFAkB,EAAcC,EAAdG,OAAAvB,gBAEgBwB,OAKZL,EAAAA,QAAcC,SAAAA,EAAdP,GACA,IAAAY,EAAAC,IAAAC,gBAAAC,GACHC,EAAA3B,SAAA4B,cAAA,OAKGD,EAAKE,UAAL,iBAAAR,OAAwC,IAANV,EAAU,SAAW,IAH3DQ,EAAUV,UAAVU,aAAAA,OAAkBI,EAAlBJ,sEACUI,cAAUE,YAAgBC,GAE5B,IAACG,EAAL7B,SAAA4B,cAAkCjB,OAC9BmB,EAACZ,IAALK,EACAN,EAAAA,UAAAA,kBAAAA,OAAA,IAAAN,EAAA,SAAA,IAEMmB,EAAKC,aAAYH,iBAAvB,eACAE,EAAAC,aAAA,mBAAApB,GACAmB,eAAAE,YAAAF,KAjBA/B,cAAUoB,UAAVpB,0MAxCRI,UAAM8B,iBAAgBjC,SAASkC,SAAAA,GAE/B/B,SAAUgC,EAAAA,OAAAA,MAAiB,GACvBpC,mBAIJK,WAAW+B,iBAAiB,SAAU,SAAAC,GACpBC,MAAAC,KAAaC,EAAAA,OAAOvB,OAC5BP,QAAQ,SAAAiB,GACN5B,GAAAA,cAAcwB,OAASW,cAAcX,OAAQ,CAC7CxB,cAAmB4B,KAAnBA,GACMc,IAAMxC,EAAQA,SAAC4B,cAArB,OACIC,EAAAA,UAAY,mBACZX,EAAAA,UAAAA,aAAAA,OAAJM,IAA6BA,gBAAIC,GAA7BP,6HACJsB,EAAIvC,cAAc,eAAewC,QAAU,WAAvCxC,cAAcH,cAAlB4C,OAA2C,SAAAC,GAAA,OAAAA,IAAMjB,IAC7C5B,EAAAA,SAAsCS,cAAtCC,kBAEAD,iBAAWyB,YAAAQ,MAMvBjC,cAHQF,mBAwCPL,SAbDE,eAAA,cAAAiC,iBAAA,mBAAA,WAcHnC,SAAAkC,iBAAA,mBAAAzB,QAAA,SAAAmC,GAAA,OAAAA,EAAAC,UAAAC,OAAA,YAIG,IAAIC,EAAYV,MAAMC,KAAKtC,SAASkC,iBAAiB,mBAAmBc,QAAQhD,SAASC,cAAc,0BAFnGD,SAACE,cAAD,qCAAAmB,OAA+C0B,EAA/C,QACJ/C,SAASkC,cAATlC,qCAAAA,OAAuD+C,EAAvD/C,OAAuD6C,UAAA9B,IAAA","file":"cars_create.min.js","sourcesContent":["let selectedFiles = [];\r\nlet mainFile = null;\r\nconst mainInput = document.querySelector('input[name=\"imagen\"]');\r\nconst imageInput = document.getElementById('imageInput');\r\nconst previewContainer = document.getElementById('previewContainer');\r\nconst thumbContainer = document.getElementById('thumbContainer');\r\nconst carouselInner = document.getElementById('mainCarouselInner');\r\nconst formsetInputs = document.querySelectorAll('#hiddenFormset input[type=\"file\"]');\r\n\r\nmainInput.addEventListener('change', e => {\r\n    mainFile = e.target.files[0];\r\n    refreshVisuals();\r\n});\r\n\r\nimageInput.addEventListener('change', e => {\r\n    const files = Array.from(e.target.files);\r\n    files.forEach(file => {\r\n        if (selectedFiles.length < formsetInputs.length) {\r\n            selectedFiles.push(file);\r\n            const div = document.createElement('div');\r\n            div.className = 'new-preview-item';\r\n            div.innerHTML = `<img src=\"${URL.createObjectURL(file)}\" class=\"rounded border w-100 h-100\" style=\"object-fit: cover;\"><div class=\"remove-new\"><i class=\"bi bi-trash\"></i></div>`;\r\n            div.querySelector('.remove-new').onclick = () => {\r\n                selectedFiles = selectedFiles.filter(f => f !== file);\r\n                div.remove();\r\n                syncFormset();\r\n                refreshVisuals();\r\n            };\r\n            previewContainer.appendChild(div);\r\n        }\r\n    });\r\n    syncFormset();\r\n    refreshVisuals();\r\n});\r\n\r\nfunction syncFormset() {\r\n    formsetInputs.forEach((input, i) => {\r\n        const dt = new DataTransfer();\r\n        if (selectedFiles[i]) dt.items.add(selectedFiles[i]);\r\n        input.files = dt.files;\r\n    });\r\n}\r\n\r\nfunction refreshVisuals() {\r\n    carouselInner.innerHTML = '';\r\n    thumbContainer.innerHTML = '';\r\n    let allImages = [];\r\n    if (mainFile) allImages.push(mainFile);\r\n    allImages = allImages.concat(selectedFiles);\r\n\r\n    if (allImages.length === 0) {\r\n        carouselInner.innerHTML = `<div class=\"carousel-item active\"><div class=\"bg-light d-flex justify-content-center align-items-center\" style=\"height: 380px;\"><i class=\"bi bi-camera fs-1 text-secondary opacity-50\"></i></div></div>`;\r\n        return;\r\n    }\r\n\r\n    allImages.forEach((file, i) => {\r\n        const url = URL.createObjectURL(file);\r\n        const item = document.createElement('div');\r\n        item.className = `carousel-item ${i === 0 ? 'active' : ''}`;\r\n        item.innerHTML = `<img src=\"${url}\" class=\"d-block w-100\" style=\"height: 380px; object-fit: cover;\">`;\r\n        carouselInner.appendChild(item);\r\n\r\n        const thumb = document.createElement('img');\r\n        thumb.src = url;\r\n        thumb.className = `thumb-selector ${i === 0 ? 'active' : ''}`;\r\n        thumb.setAttribute('data-bs-target', '#carGallery');\r\n        thumb.setAttribute('data-bs-slide-to', i);\r\n        thumbContainer.appendChild(thumb);\r\n    });\r\n}\r\n\r\ndocument.getElementById('carGallery').addEventListener('slid.bs.carousel', () => {\r\n    document.querySelectorAll('.thumb-selector').forEach(el => el.classList.remove('active'));\r\n    let activeIdx = Array.from(document.querySelectorAll('.carousel-item')).indexOf(document.querySelector('.carousel-item.active'));\r\n    if (document.querySelector(`.thumb-selector[data-bs-slide-to=\"${activeIdx}\"]`))\r\n        document.querySelector(`.thumb-selector[data-bs-slide-to=\"${activeIdx}\"]`).classList.add('active');\r\n});"]}