{"version":3,"sources":["cars_create.js"],"names":["selectedFiles","mainFile","mainInput","document","querySelector","imageInput","getElementById","previewContainer","thumbContainer","carouselInner","formsetInputs","querySelectorAll","addEventListener","e","target","files","refreshVisuals","Array","from","forEach","file","length","push","div","createElement","className","innerHTML","URL","createObjectURL","onclick","filter","f","remove","syncFormset","appendChild","input","i","dt","DataTransfer","items","add","allImages","concat","url","item","thumb","src","setAttribute","el","classList","activeIdx","indexOf"],"mappings":"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","sourcesContent":["let selectedFiles = [];\r\nlet mainFile = null;\r\nconst mainInput = document.querySelector('input[name=\"imagen\"]');\r\nconst imageInput = document.getElementById('imageInput');\r\nconst previewContainer = document.getElementById('previewContainer');\r\nconst thumbContainer = document.getElementById('thumbContainer');\r\nconst carouselInner = document.getElementById('mainCarouselInner');\r\nconst formsetInputs = document.querySelectorAll('#hiddenFormset input[type=\"file\"]');\r\n\r\nmainInput.addEventListener('change', e => {\r\n    mainFile = e.target.files[0];\r\n    refreshVisuals();\r\n});\r\n\r\nimageInput.addEventListener('change', e => {\r\n    const files = Array.from(e.target.files);\r\n    files.forEach(file => {\r\n        if (selectedFiles.length < formsetInputs.length) {\r\n            selectedFiles.push(file);\r\n            const div = document.createElement('div');\r\n            div.className = 'new-preview-item';\r\n            div.innerHTML = `<img src=\"${URL.createObjectURL(file)}\" class=\"rounded border w-100 h-100\" style=\"object-fit: cover;\"><div class=\"remove-new\"><i class=\"bi bi-trash\"></i></div>`;\r\n            div.querySelector('.remove-new').onclick = () => {\r\n                selectedFiles = selectedFiles.filter(f => f !== file);\r\n                div.remove();\r\n                syncFormset();\r\n                refreshVisuals();\r\n            };\r\n            previewContainer.appendChild(div);\r\n        }\r\n    });\r\n    syncFormset();\r\n    refreshVisuals();\r\n});\r\n\r\nfunction syncFormset() {\r\n    formsetInputs.forEach((input, i) => {\r\n        const dt = new DataTransfer();\r\n        if (selectedFiles[i]) dt.items.add(selectedFiles[i]);\r\n        input.files = dt.files;\r\n    });\r\n}\r\n\r\nfunction refreshVisuals() {\r\n    carouselInner.innerHTML = '';\r\n    thumbContainer.innerHTML = '';\r\n    let allImages = [];\r\n    if (mainFile) allImages.push(mainFile);\r\n    allImages = allImages.concat(selectedFiles);\r\n\r\n    if (allImages.length === 0) {\r\n        carouselInner.innerHTML = `<div class=\"carousel-item active\"><div class=\"bg-light d-flex justify-content-center align-items-center\" style=\"height: 380px;\"><i class=\"bi bi-camera fs-1 text-secondary opacity-50\"></i></div></div>`;\r\n        return;\r\n    }\r\n\r\n    allImages.forEach((file, i) => {\r\n        const url = URL.createObjectURL(file);\r\n        const item = document.createElement('div');\r\n        item.className = `carousel-item ${i === 0 ? 'active' : ''}`;\r\n        item.innerHTML = `<img src=\"${url}\" class=\"d-block w-100\" style=\"height: 380px; object-fit: cover;\">`;\r\n        carouselInner.appendChild(item);\r\n\r\n        const thumb = document.createElement('img');\r\n        thumb.src = url;\r\n        thumb.className = `thumb-selector ${i === 0 ? 'active' : ''}`;\r\n        thumb.setAttribute('data-bs-target', '#carGallery');\r\n        thumb.setAttribute('data-bs-slide-to', i);\r\n        thumbContainer.appendChild(thumb);\r\n    });\r\n}\r\n\r\ndocument.getElementById('carGallery').addEventListener('slid.bs.carousel', () => {\r\n    document.querySelectorAll('.thumb-selector').forEach(el => el.classList.remove('active'));\r\n    let activeIdx = Array.from(document.querySelectorAll('.carousel-item')).indexOf(document.querySelector('.carousel-item.active'));\r\n    if (document.querySelector(`.thumb-selector[data-bs-slide-to=\"${activeIdx}\"]`))\r\n        document.querySelector(`.thumb-selector[data-bs-slide-to=\"${activeIdx}\"]`).classList.add('active');\r\n});"],"file":"cars_create.dev.js"}